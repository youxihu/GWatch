# 更新日志

本文档记录 GWatch 项目的所有重要变更。

## [2.0.3] - 2025-11-05

### 修复
- 定时推送报告标题显示问题
  - 优先使用配置的 `title` 作为主机标题，而不是 hostname
  - 显示优先级：配置title > 主机名 > IP > 默认标题
- 定时推送 Redis 状态判断问题
  - 根据配置的阈值（`max_clients`/`min_clients`）正确判断状态
  - 超过阈值时显示 `[连接数过高]` 或 `[连接数过低]`，而不是总是显示 `[正常]`

---

## [2.0.2] - 2025-11-04

### 新增
- 命令行参数支持：`-c` 或 `-config` 指定配置文件
- 配置文件模板：`config/config_example.yml`

### 改进
- 更新 `.gitignore`：排除真实配置文件，保留模板
- 更新 `README.md`：添加新功能说明和使用示例
- 添加 `CHANGELOG.md`：记录所有版本更新历史

---

## [2.0.1] - 2025-11-04

### 新增
- 定时推送数据日志存储功能
  - Client：保存原始数据（JSON）到 `logs/scheduled_push/client/`
  - Server：保存聚合报告（Markdown）到 `logs/scheduled_push/server/`
  - 支持路径模板时间格式化（`%y/%m-%d/%H%M-%S`）
  - 自动清理过期日志（`retention_days`）
  - 新增配置项：`scheduled_push.data_log`

### 修复
- 定时推送报告中主机信息显示问题
  - 优先显示实际主机名和IP，而非配置的标题
  - 显示优先级：主机名 > IP > 配置标题 > "未命名主机"

---

## [2.0.0] - 2025-11-04

### 改进
- 重构定时推送功能，优化 DDD 架构和代码结构
  - 拆分代码结构：`internal/domain/scheduled_push/client`、`server`、`common`
  - 优化依赖注入：使用 Wire 管理 Client/Server 用例
  - 保持单可执行文件部署方式
  - 移除废弃的 `alert_storage` 配置

---

## 版本说明

- **[Unreleased]**：开发中的变更，尚未发布
- **版本格式**：主版本号.次版本号.修订号
  - 主版本号：不兼容的 API 修改（如 2.0.0 → 3.0.0）
  - 次版本号：向下兼容的功能性新增（如 2.0.0 → 2.1.0）
  - 修订号：向下兼容的问题修正（如 2.0.0 → 2.0.1）

## 变更类型

- **新增**：新功能
- **改进**：现有功能的改进
- **修复**：Bug 修复
- **废弃**：即将移除的功能
- **移除**：已移除的功能
- **安全**：安全相关的修复
